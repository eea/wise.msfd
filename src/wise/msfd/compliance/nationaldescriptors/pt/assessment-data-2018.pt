<div tal:define="assessment options/assessment; score_2012 python: int(options['score_2012'])">

  <table class="table table-condensed assessment-data-table">
    <tbody>

      <tr>
        <th class="as-question as-header">Question / assessed elements</th>
        <th class="as-header" tal:condition="not: assessment/gescomponents"></th>
        <th tal:repeat="g assessment/gescomponents" class="as-ges-component as-header"></th>
        <th class="as-header">Conclusion</th>
        <th class="as-th-score as-header">Score</th>
        <!-- TODO: add "conclusion score" and "Weighting" as titles -->
      </tr>

      <tal:rep tal:repeat="row assessment/answers">
        <tr>
          <th rowspan="2">
          <div class="q-wrap">
              <div class="q-id" tal:content="python: row.question.split(':')[0]">Question Id</div>
              <div class="q-title" tal:content="python: row.question.split(':', 1)[1]">Question text</div>
              </div>
          </th>
          <tal:rep tal:repeat="value row/values" >
            <td
              tal:attributes="class python: 'as-value as-value-{}'.format(value[1]);
              colspan python: len(assessment.gescomponents) - len(row.values) + 1;">

              <label for=""
                data-trigger="hover"
                data-html="true"
                tal:attributes="
                title python: value[0];
                data-content python: value[2]"
                >
                <span tal:content="python: value[2]">D0C0</span>
              </label>

            </td>
          </tal:rep>

          <td tal:attributes="class python: 'as-value as-value-{}'.format(row.conclusion_color)">
            <strong tal:content="row/conclusion">X</strong>
          </td>

          <td>
            <span tal:content="python: getattr(row.score, 'weighted_score', 0)">0</span>
            <span tal:condition="row/score"
                class="score help-popover fa fa-info-circle fa-s"
                data-trigger="hover"
                data-html="true"
                data-placement="left"
                tal:attributes="title python: 'Score calculation algorithm';
                  data-content python: getattr(row.score, 'score_tooltip', '');">
            </span>
          </td>
        </tr>
        <tr class="assessment-summary">
          <td colspan="50" tal:content="row/summary">Summary</td>
        </tr>
      </tal:rep>
      <tr>
        <th rowspan="2">Assessment summary</th>
        <td
          rowspan="2"
          colspan="50"
          tal:attributes="colspan python: len(assessment.gescomponents)"
          tal:content="assessment/assessment_summary">Summary text</td>
        <th>Overall score (%)</th>
        <td tal:content="assessment/overall_score">123</td>
      </tr>

      <tr>
        <th>Overall conclusion: 2018</th>
        <td tal:content="python:assessment.overall_conclusion[1]">124</td>
      </tr>

      <tr>
        <th rowspan="1">Progress assessment</th>
        <td tal:attributes="colspan python: len(assessment.gescomponents)">
          <form
            method="POST"
            action="./@@edit-assessment-summary"
            tal:replace="structure context/@@edit-assessment-summary">
            <textarea></textarea>
            <button name="save_progres" >Save</button>
          </form>
        </td>
        <th>Change since 2012</th>
        <td tal:content="python: assessment.overall_conclusion[0] - score_2012">+1</td>
      </tr>

      <tr tal:define="colspan python: max(len(assessment.gescomponents), 1) + 2">
        <th rowspan="1">Recommendations</th>
        <td tal:attributes="colspan colspan"
          tal:content="assessment/recommendations">Recomendation text</td>
      </tr>

    </tbody>
  </table>

  <script>
    jQuery(document).ready(function() {
      $('.help-popover').popover();
    });
  </script>
</div>
