{"version":3,"file":"msfd_search.js","sources":["../../src/js/msfd_search.js"],"sourcesContent":["/* global window, document, jQuery */\n(function(window, document, $){\n\n    /*\n       * ****************************************************\n       * Page elements init\n       * ****************************************************\n       * */\n    var exceptVal = [\"all\", \"none\", \"invert\", \"apply\"];\n    var selectorFormContainer = \".wise-search-form-container\";\n    var selectorLeftForm = \"#wise-search-form\";\n\n    var sessionStore = storageFactory(sessionStorage);\n    /*\n    * Vars and $ plugins\n    *\n    * */\n    $.randomString = function() {\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz\";\n        var string_length = 8;\n        var randomstring = '';\n        for (var i=0; i<string_length; i++) {\n            var rnum = Math.floor(Math.random() * chars.length);\n            randomstring += chars.substring(rnum,rnum+1);\n        }\n        return randomstring;\n    };\n\n    $.getMultipartData = function(frmName, newBoundary){\n        //Start multipart formatting\n        var initBoundary= newBoundary || $.randomString();\n        var strBoundary = \"--\" + initBoundary;\n        var strMultipartBody = \"\";\n        var strCRLF = \"\\r\\n\";\n\n        var iname = $(frmName).attr('id');\n\n        var formData = $(frmName).serializeArray();\n        //Create multipart for each element of the form\n\n        if(formData.length === 0){\n            return false;\n        }\n\n        var res = [];\n        var vals = {};\n\n        $.each( formData ,function(indx, val){\n            strMultipartBody +=\n                strBoundary\n                + strCRLF\n                + \"Content-Disposition: form-data; name=\\\"\" + val.name + \"\\\"\"\n                + strCRLF\n                + strCRLF\n                + val.value\n                +strCRLF;\n\n            res.push(val.name);\n            if(!vals[val.name]) vals[val.name] = [];\n            vals[val.name].push(val.value);\n        });\n\n        //End the body by delimiting it\n        strMultipartBody += strBoundary + \"--\" + strCRLF;\n\n        //Return boundary without -- and the multipart content\n        return [initBoundary,strMultipartBody, vals];\n\n    };\n\n    var loading = false;\n\n    /*\n    * Styling and hiding\n    *\n    */\n    function initStyling(){\n        var ajaxSpinner = $(\"#ajax-spinner\");\n        $(\"body\").append( ajaxSpinner.clone(true).attr(\"id\", \"ajax-spinner2\") );\n        ajaxSpinner.remove();\n\n        $(\".button-field\").addClass(\"btn\");\n        $(selectorFormContainer + \" #s2id_form-widgets-marine_unit_id\").parentsUntil(\".field\").parent().hide();\n\n        $(\"#form-buttons-continue\").hide(\"fast\");\n\n        var fbDownload = $(\"#form-buttons-download\");\n        if( fbDownload.length > 0){\n            var dBtn = fbDownload.prop('outerHTML').replace(\"input\",\"button\")\n                + ' <span style=\"margin-left:0.4rem;\">Download as spreadsheet</span>';\n            var btnForm = fbDownload.parent();\n\n            fbDownload.remove();\n\n            btnForm.append( $(dBtn) );\n            $(\"#form-buttons-download\").val(\"&#xf019; Download as spreadsheet\").addClass(\"glyphicon glyphicon-download-alt\");\n        }\n    }\n\n    /*\n    * CHECKBOXES functions\n    * */\n    function generateControlDiv(){\n        var spAll = '<span class=\"controls\">' +\n            '<span>Select :</span><a data-value=\"all\"><label>' +\n            '<span class=\"label\">All</span></label></a>';\n        var spClear = '<a data-value=\"none\"><label><span class=\"label\">Clear all</span></label></a>';\n        var invertSel = '<a data-value=\"invert\"><label><span class=\"label\">Invert selection</span></label></a>' +\n            '<div class=\"btn btn-default apply-filters\" data-value=\"apply\"><span>Apply filters</span></div>'+\n            '<span class=\"ui-autocomplete\">' +\n                '<span class=\" search-icon\" ></span>' +\n                '<span class=\"search-span\">' +\n                    '<input class=\"ui-autocomplete-input\" type=\"text\" />' +\n                    '<span class=\"clear-btn\"></span>' +\n                '</span>' +\n            '</span>';\n        return spAll + spClear + invertSel;\n    }\n\n    function searchAutoComplete(evtarget, $field){\n        var cheks2 = $field.find(\".option .label:not(.horizontal) \");\n        var labels = cheks2.parentsUntil(\".option\").parent();\n        var inputs = labels.find('input');\n        var options = labels.parent();\n        var no_results = options.find(\".noresults\");\n\n        if( $(evtarget).val() === \"\" ){\n            no_results.addClass('hidden');\n            labels.removeClass('hidden');\n            var data = $field.find('.panel').data('checked_items');\n            if (data) {\n                $.each(inputs, function (idx, el) {\n                    // 96264 in case we have an empty searchfield checked items\n                    // saved in previous query\n                    el.checked = data.indexOf(el.id) !== -1;\n                });\n            }\n            return true;\n        }\n\n        $field.find(\".apply-filters\").show();\n        //$(evtarget).find(\".apply-filters\").show();\n        labels.removeClass('hidden');\n\n        var toSearch = $( evtarget ).val().toLowerCase().replace(/\\s/g, \"_\");\n\n        var matcher = new RegExp( $.ui.autocomplete.escapeRegex( toSearch ), \"i\" );\n\n        var temp = {};\n        var checksLabels = $field.find(\".option .label:not(.horizontal) \").map(function (ind, item) {\n            temp[$(item).text().toLowerCase()] = $(item).text().toLowerCase()\n                .replace(/\\s/g, \"_\");\n            //return temp;\n            return $(item).text().toLowerCase()\n            /*.replace(/^\\s+|\\s+$/g, '')*/\n            /*.replace(/_/g, \"\")*/\n                .replace(/\\s/g, \"_\");\n        });\n\n        var found = [];\n        $.each(temp, function (indx, item) {\n            if(!matcher.test( item )){\n                found.push(indx);\n            }\n        });\n\n        var tohide = cheks2.filter(function (idx, elem) {\n            return found.indexOf( $(elem).text().toLowerCase()) !== -1;\n        });\n\n        var toshow =  cheks2.filter(function (idx, elem) {\n            return found.indexOf( $(elem).text().toLowerCase()) === -1;\n        });\n        $.each(toshow, function (ind, item) {\n            $(item).parentsUntil(\".option\").parent().find(\"[type='checkbox']\").prop(\"checked\", true);\n        });\n\n        $.each(tohide, function (inx, item) {\n            $(item).parentsUntil(\".option\").parent().find(\"[type='checkbox']\").prop(\"checked\", false);\n            $(item).parentsUntil(\".option\").parent().find(\"input[type='checkbox']\").prop(\"checked\", false);\n            $(item).parentsUntil(\".option\").parent().find(\"input[type='checkbox']\").removeAttr('checked');\n            $(item).parentsUntil(\".option\").parent().addClass('hidden');\n        });\n\n        if(tohide.length === cheks2.length) {\n            no_results.removeClass('hidden');\n        }\n        else {\n            no_results.addClass('hidden');\n        }\n    }\n\n    function addAutoComplete($field){\n        $field.find(\".ui-autocomplete-input\").autocomplete({\n            minLength: 0,\n            source: [],\n            search: function(event){\n                searchAutoComplete(event.target, $field);\n            },\n            create: function (){\n                var that = this;\n                var removeBtn = $(this).parentsUntil(\".ui-autocomplete\").find(\".clear-btn \");\n                removeBtn.on(\"click\", null ,  that, function (ev) {\n                    $(this).parentsUntil(\".controls\").find(\"input\").val(\"\");\n                    $(this).parentsUntil(\".controls\").find(\"input\").trigger(\"change\");\n                    $(ev.data).autocomplete(\"search\",\"undefined\");\n                });\n            }\n        });\n    }\n\n    function addCheckboxPanel($field, fieldId, cheks){\n        $field.addClass(\"panel-group\");\n\n        var chekspan = $field.find(\"> span:not(.controls)\");\n        // chekspan.css(\"border-radius\", 0);\n        chekspan\n            .addClass( fieldId + \"-collapse\")\n            .addClass(\"collapse\")\n            .addClass(\"panel\")\n            .addClass(\"panel-default\");\n\n        var label = $field.find(\".horizontal\");\n\n        var alabel = \"<a data-toggle='collapse' class='accordion-toggle' >\" + label.text() + \"</a>\";\n        label.html(alabel);\n\n        label.addClass(\"panel-heading\").addClass(\"panel-title\");\n\n        label.attr(\"data-toggle\", \"collapse\");\n        label.attr(\"data-target\", \".\" + fieldId + \"-collapse\" );\n\n        // if already checked than collapse\n        // double collapse fix\n        chekspan.collapse({ toggle: true });\n        chekspan.collapse({ toggle: true });\n\n        $field.find(\".accordion-toggle\").addClass(\"accordion-after\");\n\n        // hidden-colapse event\n        chekspan.on(\"hidden.bs.collapse\", function() {\n            chekspan.fadeOut(\"fast\");\n            $field.find(\".controls\").slideUp(\"fast\");\n            $field.css({\"border-bottom\" : \"1px solid #ccc;\"});\n        });\n\n        // show accordion\n        chekspan.on(\"show.bs.collapse\", function () {\n            // collapsed\n            chekspan.fadeIn(\"fast\");\n            $field.find(\".controls\").slideDown(\"fast\");\n            $field.find(\"> span\").css({\"display\" : \"block\"});\n            $field.find(\".accordion-toggle\").addClass(\"accordion-after\");\n        });\n\n        // hide accordion\n        chekspan.on(\"hide.bs.collapse\", function () {\n            // not collapsed\n            window.setTimeout( function (){\n                $field.find(\".accordion-toggle\").removeClass(\"accordion-after\");\n            },600);\n        });\n\n        // initialize autocomplete for more than 6 checkboxes\n        if(cheks.length < 6) {\n            $field.find(\".controls .ui-autocomplete\").hide();\n        } else {\n            // 96264 save checked items when having search input in case the user\n            // goes back on the search\n            chekspan.append(\"<span class='noresults hidden'>No results found</span>\");\n            chekspan.data('checked_items', []);\n\n            var data = chekspan.data('checked_items');\n            $.each($field.find('input:checked'), function(idx, el){\n                data.push(el.id);\n            });\n\n            // TIBI TODO: re-enable\n            addAutoComplete($field);\n        }\n    }\n\n    function sortCheckboxesByChecked($field) {\n        if ( window.WISE !== undefined && window.WISE.blocks !== undefined && window.WISE.blocks.indexOf( $field.attr(\"id\") ) !== -1 ){\n            return;\n        }\n        var arr = [];\n        $.each( $field.find(\".option input[type='checkbox']:not(:checked)\") , function (ix, ch) {\n            arr.push( $(ch).parent() );\n        });\n        var found = $field.find(\".option input[type='checkbox']:checked\");\n        var foundArr = [];\n        if(found.length > 0){\n            $.each(found, function (ix, item) {\n                foundArr.push($(item).parent() );\n            });\n        }\n        var all = foundArr.concat(arr);\n\n        $.each( all, function (ix, ch) {\n            $field.find(\".panel\").append(ch);\n        });\n    }\n\n    // enable autosubmit handler\n    function fieldAutoSubmitSetup(fieldId, $field){\n        $(\"#\" + fieldId).on(\"click\", \".option\", function (){\n            var self = this;\n            $(\"#ajax-spinner2\").hide();\n            //window.WISE.blocks = window.WISE.blocks.sort().filter((x, i, a) => !i || x != a[i-1]);\n\n            if( window.WISE.blocks.indexOf( $(this).parentsUntil(\".field\").parent().attr(\"id\") ) !== -1  ){\n                sortCheckboxesByChecked($field);\n            } else {\n                //TODO : check if apply-filters shown\n                // each checkbox does auto submit\n                window.setTimeout( function() {\n                    $(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\", {'button': self})\n                }, 300);\n            }\n        });\n    }\n\n    function generateCheckboxes($fields, $fieldsnr){\n        var count = $fieldsnr;\n        $fields.each(function(indx, field){\n            var $field = $(field);\n            var cheks = $field.find(\".option\");\n            var allcheckboxes = cheks.find(\"input[type='checkbox']\");\n            var hasChecks = allcheckboxes.length > 0;\n            // has checkboxes\n            if(hasChecks){\n                var fieldId = $field.attr(\"id\");\n\n                fieldAutoSubmitSetup(fieldId, $field);\n\n                // add \"controls\"\n                var all = generateControlDiv();\n                $field.find(\"> label.horizontal\").after(all);\n\n                //tooltips\n                cheks.each(function (idx) {\n                    var text = $(cheks[idx]).text();\n                    $(cheks[idx]).attr(\"title\", text.trim());\n                });\n\n                if(cheks.length < 4) {\n                    $field.find(\".controls a\").hide();\n                    $field.find(\".controls\").html(\"\").css(\"height\" ,\"1px\").css(\"padding\", 0);\n                } else {\n                    addCheckboxPanel($field, fieldId, cheks);\n\n                    $field.find(\".search-icon\").on(\"click\" , function (ev) {\n                        $(ev.target).parent().find(\"input\").trigger(\"focus\");\n                    });\n                }\n\n                sortCheckboxesByChecked($field);\n            }\n            if (!--count) $(selectorFormContainer + \",\" + selectorLeftForm).animate({\"opacity\" : 1}, 1000);\n\n        });\n    }\n\n    function checkboxHandlerAll(ev){\n        ev.preventDefault();\n\n        var par = $(this).parent().parent();\n\n        window.WISE.blocks.push( $(this).parentsUntil(\".field\").parent().attr(\"id\") );\n\n        par.find(\".apply-filters\").show();\n        var rest = filterInvalidCheckboxes($(par).find(\"[type='checkbox']\"));\n\n        $.each(rest, function (idx) {\n            if($(rest[idx]).val() !== \"all\" && $(rest[idx]).val() !== \"none\") $(rest[idx]).prop(\"checked\", true);\n        });\n\n        //$( selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n    }\n\n    function checkboxHandlerNone(ev){\n        ev.preventDefault();\n\n        $(this).prop(\"checked\", false);\n        var par = $(this).parent().parent();\n        par.find(\".apply-filters\").show();\n        var rest = filterInvalidCheckboxes($(par).find(\"[type='checkbox']\"));\n\n        window.WISE.blocks.push( $(this).parentsUntil(\".field\").parent().attr(\"id\") );\n\n        $.each(rest, function (idx) {\n            $(rest[idx]).prop(\"checked\", false);\n            //if( $(rest[idx]).val() !== \"none\")\n        });\n\n        //$( selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n    }\n\n    function checkboxHandlerInvert(ev){\n        ev.preventDefault();\n        $(this).prop(\"checked\", false);\n\n        var par = $(this).parent().parent();\n        par.find(\".apply-filters\").show();\n\n        window.WISE.blocks.push( $(this).parentsUntil(\".field\").parent().attr(\"id\") );\n\n        var rest = filterInvalidCheckboxes($(par).find(\"[type='checkbox']\"));\n\n        var checked = rest.filter(function (ind, item) {\n            return $(item).is(\":checked\");\n        });\n\n        var unchecked = rest.filter(function (ind, item) {\n            return !$(item).is(\":checked\");\n        });\n\n        $.each(checked, function (idx) {\n            $(checked[idx]).prop(\"checked\", false);\n        });\n\n        $.each(unchecked, function (idx) {\n            $(unchecked[idx]).prop(\"checked\", true);\n        });\n        //$( selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n    }\n\n    function addCheckboxHandlers(){\n        var $controls = $(\".controls\");\n        $controls.on(\"click\",\"a[data-value='all']\", checkboxHandlerAll);\n        $controls.on(\"click\", \"a[data-value='none']\", checkboxHandlerNone);\n        $controls.on(\"click\", \"a[data-value='invert']\", checkboxHandlerInvert);\n        //$(\".controls .apply-filters\").on(\"click\", $( selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\") );\n\n        $controls.one(\"click\",\".apply-filters\", function () {\n            $(selectorFormContainer + \" [name='form.widgets.page']\").val(0);\n            $(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\", {'button': this});\n        });\n    }\n\n    function filterInvalidCheckboxes(cbxs){\n        return cbxs.filter(function (idx, item) {\n            return exceptVal.indexOf($(item).val()) === -1;\n        });\n    }\n\n    function addCheckboxLabelHandlers(){\n        var allch = $( selectorFormContainer + \", \" + selectorLeftForm ).find(\"[data-fieldname]\");\n\n        var triggerClick = function (chV, ev){\n            //reset page\n             $(selectorFormContainer + \" [name='form.widgets.page']\").val(0);\n             if( exceptVal.indexOf(chV) === -1) $(ev.target).find(\"input[type='checkbox']\").trigger('click');\n        };\n\n        // listener for click on the whole span\n        allch.on(\"click\", \".option\", function(ev){\n            $(\"#ajax-spinner2\").hide();\n            var checkboxV = $(this).find(\"input[type='checkbox']\").val();\n            if( window.WISE.blocks.indexOf( $(this).parentsUntil(\".field\").parent().attr(\"id\") ) !== -1  ){\n                //return false;\n            } else {\n               triggerClick(checkboxV, ev);\n            }\n        });\n    }\n    /*\n    * CHECKBOXES functions END\n    * */\n\n    /*\n    * SELECT2 functions\n    * */\n    function setupRightSelects2(selector){\n        var forbiddenIDs = [\"form-widgets-member_states-from\", \"form-widgets-member_states-to\" ];\n        var selectorFormCont = selector || selectorFormContainer;\n\n        $( selectorFormCont + \" select\").each(function (ind, selectElement) {\n            var selectedElementID = $(selectElement).attr(\"id\");\n            if( forbiddenIDs.indexOf(selectedElementID) !== -1 ){\n                return false;\n            }\n\n            $(selectElement).addClass(\"js-example-basic-single\");\n            var lessOptions = $(selectElement).find(\"option\").length < 10;\n\n            var $wise_search_form = $(selectorFormCont);\n\n            var options = {\n                placeholder: 'Select an option',\n                closeOnSelect: true,\n                dropdownAutoWidth : true,\n                width: '100%',\n                theme: \"flat\"\n            };\n            if(lessOptions) options.minimumResultsForSearch = Infinity;\n\n            $(selectElement).select2(options);\n\n            $(selectorFormCont + \" #s2id_form-widgets-marine_unit_id\").hide();\n\n            var removePaginationButtons = function(){\n                $wise_search_form.find(\"[name='form.buttons.prev']\").remove();\n                $wise_search_form.find(\"[name='form.buttons.next']\").remove();\n                $wise_search_form.find(\"[name='form.widgets.page']\").remove();\n            };\n\n            $(selectElement).on(\"select2-selecting\", function(ev) {\n                // remove results following form-widgets-article select element\n                // as we want to reset each facet to it's initial value if we change form\n                if( $(this).attr(\"id\") === \"form-widgets-article\" ) {\n                    //$(ev.target).closest(\".form-right-side\").next().remove();\n                }\n\n                removePaginationButtons()\n\n                var self = this;\n                window.setTimeout( function (){\n                    $(selectorFormCont + \" .formControls #form-buttons-continue\").trigger(\"click\", {'select': self});\n                }, 300);\n            });\n        });\n    }\n\n    function formatArticle (article) {\n      var el = $(article.element[0]);\n      var subtitle = el.attr(\"data-subtitle\");\n\n      return '<span>' +\n                el.attr(\"data-maintitle\") + ': ' +\n                subtitle +\n              '</span>';\n    }\n\n    function marineUnitSelect() {\n      var $selectArticle = $(\"#mobile-select-article\");\n\n      var moptions = {\n        placeholder: 'Select an option',\n        closeOnSelect: true,\n        // dropdownAutoWidth: true,\n        // width: 'auto',\n        width: 'element',\n        theme: \"flat\",\n        minimumResultsForSearch: 20,\n        formatSelection: formatArticle,\n        formatResult: formatArticle,\n        containerCssClass: \"mobile-select-article\"\n      };\n\n      if ($.fn.select2 !== undefined) {\n        $selectArticle.select2(moptions);\n        $selectArticle.one(\"select2-selecting\", function (ev) {\n          document.location.href = ev.choice.id;\n        });\n      }\n    }\n\n    function setupLeftSelect2(){\n        var marineUnitTriggerSelector = \"#marine-unit-trigger\";\n        if(  ($( selectorLeftForm + \" select:not(.notselect)\").hasClass(\"js-example-basic-single\")) ){\n            return false;\n        }\n        $( selectorLeftForm + \" select:not(.notselect)\").addClass(\"js-example-basic-single\").each(function (ind, selectElement) {\n            var options = {\n                placeholder: 'Select an option',\n                closeOnSelect: true,\n                dropdownAutoWidth : false,\n                width: 'auto',\n                theme: \"flat\",\n                minimumResultsForSearch: 20,\n                allowClear: true,\n                dropdownParent: \"#marine-unit-trigger\",\n                dropdownAdapter: \"AttachContainer\",\n                containerCssClass : \"select2-top-override\",\n                dropdownCssClass: \"select2-top-override-dropdown\",\n                debug: true\n            };\n\n            $(selectElement).select2(options);\n\n            // david\n            $(selectElement).parentsUntil(\".field\").parent().prepend(\"<h4>Marine Unit ID: </h4>\");\n\n            $(selectElement).on(\"select2-open\", function() {\n                var trh = $( marineUnitTriggerSelector ).offset().top;\n                //$(\".select2-top-override-dropdown\").css(\"margin-top\", $(\"#marine-unit-trigger\").height()/2 + \"px\" );\n                $( marineUnitTriggerSelector + \" .arrow\").hide();\n                $(\".select2-top-override-dropdown\").css({\n                    \"top\": trh + $( marineUnitTriggerSelector ).height() - $( marineUnitTriggerSelector + \" .arrow\").height() + \"px\",\n                    \"margin-top\": \"12\" + \"px !important\"\n                });\n            });\n\n            $(selectElement).on(\"select2-selecting\", function(ev) {\n                //$(selectorLeftForm + \" \"+  marineUnitTriggerSelector +\"  a\").text(ev.object.text);\n\n                $(selectorFormContainer + \" [name='form.widgets.page']\").val(0);\n                $(selectorFormContainer + \" #form-widgets-marine_unit_id\").select2().val(ev.val).trigger(\"change\");\n                $(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\", {'select': ev.target, \"from_marine_widget\": true});\n            });\n\n            $(selectElement).on(\"select2-close\", function () {\n                $( marineUnitTriggerSelector ).css(\"background\", \"transparent\");\n                $( marineUnitTriggerSelector + \" a\").css(\"background\", \"transparent\");\n                $( marineUnitTriggerSelector + \" .arrow\").show();\n            });\n\n            /// Marine Unit id selector\n            if ($(selectorLeftForm + ' select').hasClass(\"js-example-basic-single\")) {\n                // Select2 has been initialized\n                var text = $(selectorLeftForm + ' select [value=\"' + jQuery(selectorLeftForm + ' .select-article select').val() + '\"]').text();\n                $( selectorLeftForm + ' select:not(.notselect)').parentsUntil(\".field\").before('<div id=\"marine-unit-trigger\">' +\n                    '<div class=\"text-trigger\">'+ text +\n                    '</div>' +\n                    '</div>');\n\n                $(marineUnitTriggerSelector).on(\"click\", function () {\n                    if(loading) return false;\n                    $( marineUnitTriggerSelector ).css(\"background\", \"rgb(238, 238, 238)\");\n                    $( marineUnitTriggerSelector + \" a\").css(\"background\", \"rgb(238, 238, 238)\");\n\n                    $( selectorLeftForm + ' select:not(.notselect)').select2(\"open\");\n\n                    var trH = $( marineUnitTriggerSelector + \" a\").height();\n                    $(\".select2-top-override-dropdown\").css(\"margin-top\", trH/2 + \"px\" );\n                });\n\n            }\n        });\n    }\n\n    function attachSelect2(){\n        setupRightSelects2();\n        setupLeftSelect2();\n        marineUnitSelect();\n\n        var w = \"auto\";\n        var daw = true;\n        if (window.matchMedia(\"(max-width: 967px)\").matches) {\n            w = false;\n            daw = false;\n        }\n\n        var options = {\n            placeholder: 'Select an option',\n            closeOnSelect: true,\n            dropdownAutoWidth : daw,\n            width: w,\n            theme: \"flat\",\n            minimumResultsForSearch: 20,\n            containerCssClass : \"extra-details-select\"\n        };\n\n        $.each( $( selectorLeftForm + \" .extra-details-select\") , function (idx, elem) {\n            if($(elem).find(\"option\").length > 1){\n                $(elem).select2(options);\n            } else {\n                $(elem).hide();\n                //$(elem).after(\"<span>\"+ $($(elem).find(\"option\")[0]).attr(\"title\") +\"</span>\");\n            }\n        });\n\n        $( selectorLeftForm + \" .extra-details .tab-panel\").fadeOut('slow', function () {\n            $.each( $( selectorLeftForm + \" .extra-details .extra-details-section\"), function (indx, item){\n                $($(item).find(\".tab-panel\")[0]).show();\n            });\n        });\n\n        $( selectorLeftForm + \" .extra-details-select\").on(\"select2-selecting\", function(ev) {\n            var sect = $(ev.target).parentsUntil(\".extra-details-section\").parent();\n            $.each( $(sect).find(\".tab-panel\") , function (idx, elem) {\n                if ($(elem).attr(\"id\") !== ev.choice.id) {\n                    $(elem).hide();\n                } else {\n                    $(elem).fadeIn();\n                }\n            });\n\n        });\n    }\n    /*\n    * SELECT2 functions END\n    * */\n\n    function marineBtnHandler(ev){\n        var direction = ev.data.direction;\n        var marinUidSelect = $( selectorFormContainer + \" #s2id_form-widgets-marine_unit_id\");\n        var selectedV =  marinUidSelect.select2('data');\n\n        var nextEl  = $(selectedV.element[0]).next();\n        var prevEl = $(selectedV.element[0]).prev();\n\n        if(direction === \"next\"){\n            var dir = nextEl.val();\n\n        } else if(direction === \"prev\"){\n            var dir = prevEl.val();\n        }\n\n        // reset paging\n        $(selectorFormContainer + \" [name='form.widgets.page']\").remove();\n\n        $(selectorFormContainer + \" #form-widgets-marine_unit_id\").select2().val(dir).trigger(\"change\", { \"from_marine_widget\": true});\n        $(selectorFormContainer + \" #s2id_form-widgets-marine_unit_id\").hide();\n\n        //$(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n        $(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n\n    }\n\n    function setPaginationButtons(){\n        var prevButton = $(\".msfd-search-wrapper [name='form.buttons.prev']\");\n        var nextButton = $(\".msfd-search-wrapper [name='form.buttons.next']\");\n        var continueBtn = \".formControls #form-buttons-continue\";\n\n        prevButton.one(\"click\", function (){\n            if(loading) return false;\n            $( selectorFormContainer).find(\"form\").append(\"<input type='hidden' name='form.buttons.prev' value='Prev'>\");\n            $( selectorFormContainer).find(  continueBtn ).trigger(\"click\");\n        });\n\n        nextButton.one(\"click\", function(){\n            if(loading) return false;\n            $( selectorFormContainer ).find(\"form\").append(\"<input type='hidden' name='form.buttons.next' value='Next'>\");\n            $(selectorFormContainer).find( continueBtn ).trigger(\"click\");\n        });\n\n        var selected = $( selectorLeftForm + \" select:not(.notselect)\").val();\n\n        var opts = $( selectorLeftForm + \" select:not(.notselect) option\");\n        var formBtnPrevTop = \"#form-buttons-prev-top\";\n        var formBtnNextTop = \"#form-buttons-next-top\";\n        var marineUnitTrigger = \"#marine-unit-trigger\";\n\n        $(\"#marine-unit-nav\").hide();\n        // ignore 1st option for \"prev\" button\n        if( $( selectorLeftForm + \" select:not(.notselect)\").val() !== $(opts[1]).val() ){\n\n            var topPrevBtn = '<button type=\"submit\" id=\"form-buttons-prev-top\" name=\"marine.buttons.prev\"' +\n                ' class=\"submit-widget button-field btn btn-default pagination-prev\" value=\"\" button=\"\">' +\n                '          </button>';\n\n            $(formBtnPrevTop).append(topPrevBtn);\n\n            $( formBtnPrevTop ).on(\"click\", null, { direction : \"prev\"} , marineBtnHandler);\n            $( formBtnPrevTop ).hide();\n            $( marineUnitTrigger + \" .arrow-left-container\").one(\"click\", function(){\n                $(formBtnPrevTop).trigger(\"click\");\n            });\n        } else {\n            $( marineUnitTrigger + \" .arrow-left-container\").hide();\n            $(\".text-trigger\").css(\"margin-left\", 0);\n        }\n\n        // ignore last option for \"next\" button\n        if( $( selectorLeftForm + \" select:not(.notselect)\").val() !== $(opts[opts.length-1]).val() ){\n            var topNextBtn = '<button type=\"submit\" ' +\n                'id=\"form-buttons-next-top\" name=\"marine.buttons.next\" class=\"submit-widget button-field btn btn-default pagination-next\" value=\"\">' +\n                '            </button>';\n\n            $(formBtnNextTop).append(topNextBtn);\n\n            $(formBtnNextTop).on(\"click\", null, { direction : \"next\"} , marineBtnHandler);\n            $(formBtnNextTop).hide();\n            $( marineUnitTrigger + \" .arrow-right-container\").one(\"click\",function(){\n                $(\"#form-buttons-next-top\").trigger(\"click\")\n            });\n        } else {\n            $( marineUnitTrigger + \" .arrow-right-container\").hide();\n        }\n    }\n\n    var paginationTextResult = \".pagination-text > span:first-child\";\n\n    function initPaginationInput(){\n        // check if results more than 2, if not then disable\n        if(parseInt($($(\".pagination-text > span:nth-child(2)\")[0]).text()) < 3){\n            return false;\n        }\n\n        $(paginationTextResult).addClass(\"pagination-result\");\n\n\n        if($(paginationTextResult).parent().find(\"input\").length === 0){\n            $(paginationTextResult).after('<input type=\"text\" class=\"pagination-input\" />');\n            $(\".pagination-text .pagination-input\").hide();\n\n            paginationInputHandlers();\n        }\n\n        $(\".msfd-search-wrapper\").on(\"click\", paginationTextResult, function (ev){\n            $(ev.target).parent().find(\"input\").show(300).focus().css(\"display\", \"inline-block\");\n            $(ev.target).hide();\n        });\n\n        $(\".msfd-search-wrapper\").on(\"click\", function (ev) {\n            // if click is on the result text\n            if($(ev.target).is(paginationTextResult) || $(ev.target).is(\".pagination-text .pagination-input\") ) {\n\n            } else {\n                $(paginationTextResult).parent().find(\"input\").hide();\n                $(paginationTextResult).show();\n            }\n        });\n\n    }\n\n    function paginationInputHandlers(){\n        var inp = $(\".pagination-text .pagination-input\");\n\n        // hide pagination input on focus out\n        /*inp.on(\"focusout\", function (){\n            inp.hide();\n            $(paginationTextResult).show();\n        });*/\n\n        // pagination input delay auto-submit\n        inp.bind('focusout', function(e) {\n            var val = $(e.target).val();\n            var maximum = parseInt( $($(e.target).parent().find(\"> span\")[1]).text());\n\n            if(loading){\n                return false;\n            }\n\n            var _this = $(this);\n            var validateNr = function(x, maximum){\n                if (isNaN(parseInt(x))){\n                    return false;\n                } else {\n                    x = parseInt(x);\n                    var res = $( $(paginationTextResult)[0] ).text();\n                    if(x === parseInt(res)){\n                        return false;\n                    }\n                    if(x > maximum){\n                        return maximum - 1;\n                    }\n                    if(x <= 0){\n                        return false;\n                    }\n                }\n                return x === 1 ? 0 : x-1;\n\n            };\n            var validator = validateNr(val, maximum );\n                if(validator !== false){\n                    $(selectorFormContainer + \" [name='form.widgets.page']\").val(validator);\n                    $(paginationTextResult).text(val);\n                    $(paginationTextResult).show();\n                    $(paginationTextResult).parent().find(\"input\").hide();\n                    $(selectorFormContainer + \" .formControls #form-buttons-continue\").trigger(\"click\");\n                } else {\n                    $(e.target).val(\"\");\n                    $(paginationTextResult).parent().find(\"input\").hide();\n                    $(paginationTextResult).show();\n                }\n\n        });\n    }\n\n    function initPageElems(){\n        // move marine unit id below form title and pagination as seen on the\n        // other article tabs\n        var pagination = $('.prev-next-row').eq(0);\n        if (pagination.length) {\n            $(\"#marine-widget-top\").detach().insertBefore(pagination);\n        }\n\n        initStyling();\n\n        var $fields = $( selectorFormContainer + \", \" + selectorLeftForm ).find(\"[data-fieldname]\");\n        if($fields.length > 0){\n            generateCheckboxes( $fields, $fields.length );\n        }\n\n        $(selectorFormContainer + \",\" + selectorLeftForm).animate({\"opacity\" : 1}, 1000);\n\n        addCheckboxHandlers( $(selectorFormContainer) );\n        addCheckboxLabelHandlers();\n        attachSelect2();\n\n        if(\"undefined\" !== typeof window.setupTabs && null !== window.setupTabs) window.setupTabs();\n\n        if( \"undefined\" !== typeof clickFirstTab && null !== clickFirstTab ) clickFirstTab();\n\n        setPaginationButtons();\n        initPaginationInput();\n    }\n\n    /*\n    * Form handlers\n    * */\n    function beforeSendForm(jqXHR, settings) {\n        window.WISE.blocks = [];\n        //$(\"#ajax-spinner2\").hide();\n\n        $( selectorLeftForm + \" .no-results\").remove();\n\n        var t = \"<div id='wise-search-form-container-preloader'/>\";\n        var sp = $(\"#ajax-spinner2\").attr(\"id\", \"ajax-spinner-form\").show();\n\n        $(selectorFormContainer).append(t);\n        $(\"#wise-search-form-container-preloader\").append(sp);\n\n\n        $(\"#form-widgets-marine_unit_id\").prop(\"disabled\", true);\n        //$(\"s2id_form-widgets-marine_unit_id\").select2(\"enable\",false);\n        $(\"[name='form.buttons.prev']\").prop(\"disabled\" , true);\n        $(\"[name='form.buttons.next']\").prop(\"disabled\" , true);\n\n        $(\"[name='marine.buttons.prev']\").prop(\"disabled\" , true);\n        $(\"[name='marine.buttons.next']\").prop(\"disabled\" , true);\n\n        if($(\"#marine-widget-top\").length > 0){\n            var cont = $(\"#marine-widget-top\").next();\n            cont.css(\"position\", \"relative\");\n        } else {\n            cont = $(\".left-side-form\");\n        }\n\n        cont.prepend(\"<div id='wise-search-form-preloader'/>\");\n\n        $(\"#wise-search-form-preloader\")\n            .append(\"<span style='position: absolute;\" +\n                \" display: block;\" +\n                \" left: 50%;\" +\n                \"top: 10%;'></span>\");\n        $(\"#wise-search-form-preloader > span\")\n        .append($(\"#ajax-spinner2\")\n          .clone()\n          .attr(\"id\",\"ajax-spinner-center\" )\n          .show());\n\n        $(\"#ajax-spinner-center\").css({\n            \"position\" : \"fixed\"\n            //\"top\" : \"50%\",\n            //\"left\" : \"30%\",\n            // \"transform\" : \"translateX(-50%)\"\n        });\n\n         $(\"#wise-search-form-top\").find(\".alert\").remove();\n        //window.WISE.marineUnit = $(selectorLeftForm + \" select\").val(  );\n\n        loading = true;\n    }\n\n    function formSuccess(data, status, req) {\n        $( selectorLeftForm + \" #wise-search-form-top\").siblings().html(\"\");\n        $( selectorLeftForm + \" #wise-search-form-top\").siblings().fadeOut(\"fast\");\n\n        $( selectorLeftForm + \" .topnav\").next().remove();\n\n        var $data = $(data);\n\n        window.WISE.formData = $(data).find(selectorFormContainer).clone(true);\n\n        var chtml = $data.find(selectorFormContainer);\n\n        var fhtml = chtml.html();\n\n        var centerContentD = $data.find( selectorLeftForm + \" #wise-search-form-top\").siblings();\n\n        $(selectorFormContainer).html(fhtml);\n\n\n        if( $data.find( selectorLeftForm + \" .topnav\").next().length > 0){\n            $( selectorLeftForm + \" .topnav\").after($data.find( selectorLeftForm + \" .topnav\").next());\n        }\n\n        $( selectorLeftForm + \" #wise-search-form-top\").siblings().remove();\n        $( selectorLeftForm + \" #wise-search-form-top\").after(centerContentD);\n\n        /*var res = $data.find( selectorLeftForm );\n\n        if(res.children().length === 1){\n            if($(res[0]).attr(\"id\") === \"wise-search-form-top\" ){\n                $( selectorLeftForm + \" #wise-search-form-top\").after(\"<span class='no-results'>No results found.</span>\");\n            }\n\n        }*/\n\n        initPageElems();\n        removeNoValues();\n        fixTableHeaderAndCellsHeight();\n        //addDoubleScroll();\n\n        $(\"[name='form.buttons.prev']\").prop(\"disabled\" , false);\n        $(\"[name='form.buttons.next']\").prop(\"disabled\" , false);\n\n        $(\"[name='marine.buttons.prev']\").prop(\"disabled\" , false);\n        $(\"[name='marine.buttons.next']\").prop(\"disabled\" , false);\n        $(\"#wise-search-form-top\").find(\".alert\").remove();\n\n    }\n\n     /* - table_sorter.js - */\n    /********* Table sorter script *************/\n    /*\n     * For all table elements with 'listing' class,\n     * when user clicks on a th without 'nosort' class,\n     * it sort table values using the td class with 'sortabledata-mydata' name,\n     * or the td text content\n     *\n     */\n    function sortabledataclass(cell){\n        var re, matches;\n\n        re = new RegExp(\"sortabledata-([^ ]*)\",\"g\");\n        matches = re.exec(cell.attr('class'));\n        if (matches) { return matches[1]; }\n        else { return null; }\n    }\n\n    function sortable(cell) {\n        // convert a cell a to something sortable\n\n        // use sortabledata-xxx cell class if it is defined\n        var text = sortabledataclass(cell);\n        if (text === null) { text = cell.text(); }\n\n        // A number, but not a date?\n        if (text.charAt(4) !== '-' && text.charAt(7) !== '-' && !isNaN(parseFloat(text))) {\n            return parseFloat(text);\n        }\n        return text.toLowerCase();\n    }\n\n    function sort() {\n        var th, colnum, table, tbody, reverse, index, data, usenumbers, tsorted;\n\n        th = $(this).closest('th');\n        colnum = $('th', $(this).closest('thead')).index(th);\n        table = $(this).parents('table:first');\n        tbody = table.find('tbody:first');\n        tsorted = parseInt(table.attr('sorted') || '-1', 10);\n        reverse = tsorted === colnum;\n\n        $(this).parent().find('th:not(.nosort) .sortdirection')\n            .html('&#x2003;');\n        $(this).children('.sortdirection').html(\n            reverse ? '&#x25b2;' : '&#x25bc;');\n\n        index = $(this).parent().children('th').index(this),\n        data = [],\n        usenumbers = true;\n        tbody.find('tr').each(function() {\n            var cells, sortableitem;\n\n            cells = $(this).children('td');\n            sortableitem = sortable(cells.slice(index,index+1));\n            if (isNaN(sortableitem)) { usenumbers = false; }\n            data.push([\n                sortableitem,\n                // crude way to sort by surname and name after first choice\n                sortable(cells.slice(1,2)), sortable(cells.slice(0,1)),\n                this]);\n        });\n\n        if (data.length) {\n            if (usenumbers) {\n                data.sort(function(a,b) {return a[0]-b[0];});\n            } else {\n                data.sort();\n            }\n            if (reverse) { data.reverse(); }\n            table.attr('sorted', reverse ? '' : colnum);\n\n            // appending the tr nodes in sorted order will remove them from their old ordering\n            tbody.append($.map(data, function(a) { return a[3]; }));\n            // jquery :odd and :even are 0 based\n            tbody.each(setoddeven);\n        }\n    }\n\n    function setoddeven() {\n        var tbody = $(this);\n        // jquery :odd and :even are 0 based\n        tbody.find('tr').removeClass('odd').removeClass('even')\n            .filter(':odd').addClass('even').end()\n            .filter(':even').addClass('odd');\n    }\n\n    function formAjaxComplete(jqXHR, textStatus){\n        if(textStatus === \"success\"){\n            $(selectorFormContainer).fadeIn(\"fast\", function () {\n                $( selectorLeftForm + \" #wise-search-form-top\").siblings().fadeIn(\"fast\");\n            });\n        }\n\n        $(selectorFormContainer).find(\"[name='form.buttons.prev']\").remove();\n        $(selectorFormContainer).find(\"[name='form.buttons.next']\").remove();\n\n        //$(\"s2id_form-widgets-marine_unit_id\").select2().enable(true);\n\n        $( selectorLeftForm + \" #loader-placeholder\").remove();\n\n        $(\"#form-widgets-marine_unit_id\").prop(\"disabled\", false);\n\n        //if($( selectorLeftForm + \" select\").val() === \"--NOVALUE--\" ) $( selectorLeftForm + \" select\").val(window.WISE.marineUnit).trigger(\"change.select2\");\n        if ( $(selectorLeftForm + ' select').hasClass(\"js-example-basic-single\")) {\n            // Select2 has been initialized\n            if( ( $( selectorLeftForm + \" .select2-choice\").width()/2 ) <= $( selectorLeftForm + \" #select2-chosen-3\").width() ){\n                $( selectorLeftForm + \" .select2-choice\").css(\"width\", \"50%\");\n            } else if ( 2*( $( selectorLeftForm + \" .select2-choice\").width()/3 ) <= $( selectorLeftForm + \" #select2-chosen-3\").width() ) {\n                $( selectorLeftForm + \" .select2-choice\").css(\"width\", \"70%\");\n            }\n\n        }\n\n        if($(\"#wise-search-form-top\").next().length === 0){\n            $( selectorLeftForm + \" #wise-search-form-top\").after(\"<span class='no-results'>No results found.</span>\");\n        }\n\n        loading = false;\n\n        // set up blank spaceholder gif\n        var blankarrow = $('<span>&#x2003;</span>').addClass('sortdirection');\n        // all listing tables not explicitly nosort, all sortable th cells\n        // give them a pointer cursor and  blank cell and click event handler\n        // the first one of the cells gets a up arrow instead.\n        $('table.listing:not(.nosort) thead th:not(.nosort)')\n            .append(blankarrow.clone())\n            .css('cursor', 'pointer')\n            .click(sort);\n        $('table.listing:not(.nosort) tbody').each(setoddeven);\n\n        if ( typeof scanforlinks !== \"undefined\") jQuery(scanforlinks);\n\n        addDoubleScroll();\n    }\n\n    function formAjaxError(req, status, error){\n        /*if(window.WISE.formData.length > 0){\n            var data = $($(window.WISE.formData)[0]).find(\".field\");\n            $.each( data , function (indx, $field) {\n                var chk = $($field).find(\".option input[type='checkbox']:checked\");\n                if(chk.length > 0){\n                    // TODO\n                }\n\n            });\n        }*/\n\n        $(\"#wise-search-form-top\").find(\".alert\").remove();\n        $(\"#wise-search-form-top\").append('<div class=\"alert alert-danger alert-dismissible show\" style=\"margin-top: 2rem;\" role=\"alert\">' +\n            '  <strong>There was a error from the server.</strong> You should check in on some of those fields from the form.' +\n            '  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">' +\n            '    <span aria-hidden=\"true\">&times;</span>' +\n            '  </button>' +\n            '</div>');\n\n        $( selectorFormContainer ).find(\"[name='form.buttons.prev']\").remove();\n        $( selectorFormContainer ).find(\"[name='form.buttons.next']\").remove();\n        $(\"#form-widgets-marine_unit_id\").prop(\"disabled\", false);\n\n        $(\"#wise-search-form-container-preloader\").remove();\n        $(\"#wise-search-form-preloader\").remove();\n\n        $(\"#ajax-spinner-form\").hide();\n\n        $(\"[name='form.buttons.prev']\").prop(\"disabled\" , true);\n        $(\"[name='form.buttons.next']\").prop(\"disabled\" , true);\n\n        $(\"[name='marine.buttons.prev']\").prop(\"disabled\" , true);\n        $(\"[name='marine.buttons.next']\").prop(\"disabled\" , true);\n\n        if (typeof Storage !== 'undefined') {\n            sessionStore.removeItem(\"form\")\n        }\n\n        loading = false;\n    }\n\n    function resetEmptyCheckboxes(fieldID){\n        $.each( $(\"#\" + fieldID ).find('.option'), function (idx, item){\n            $(item).find(\"[type='checkbox']\").prop(\"checked\", true);\n        });\n    }\n\n    function resetConfigsbelowFacet(called_from, called_from_button, called_from_select, args){\n        var empty_next_inputs;\n        var empty_sibling_input;\n        if (!called_from || called_from_button || called_from_select) {\n            empty_next_inputs = function(el) {\n                var panel_group, subform_parent, subform_children;\n                panel_group = $(el).closest('.panel-group');\n                subform_parent = panel_group.closest('.subform');\n                subform_children = subform_parent.find('.subform');\n\n                panel_group.nextAll('.panel-group').find('.panel').empty();\n                if (subform_children.length) {\n                    if(subform_children.hasClass(\"subform\")){\n                        subform_children.empty();\n                    }\n                    subform_children.find('.panel').empty();\n                    subform_children.find(\".subform\").empty();\n                } else {\n                    $(el).parent().parent().next().empty();\n                }\n            };\n\n            empty_sibling_input = function (el) {\n                var nextFieldID = $(el).parent().next().attr(\"id\");\n\n                var panel_group, subform_parent, subform_children;\n                panel_group = $(el).closest('.panel-group');\n                subform_parent = panel_group.closest('.subform');\n                //subform_children = subform_parent.find('.subform');\n                 subform_children = $(el).parent().parent().next();\n\n                if(called_from.from_marine_widget !== undefined || called_from.from_marine_widget === true){\n                    return true;\n                }\n\n                if( nextFieldID === \"formfield-form-widgets-member_states\" ){\n                    resetEmptyCheckboxes(nextFieldID);\n                } else {\n                    resetEmptyCheckboxes(\"memberstatesform\");\n                }\n                panel_group.nextAll('.panel-group').find('.panel').empty();\n                if (subform_children.length) {\n                    subform_children.find(\".subform\").empty();\n                }\n\n            };\n            if (called_from_button) {\n                empty_next_inputs(called_from_button);\n            } else if(called_from_select){\n                empty_sibling_input(called_from_select);\n            }\n            else {\n                $(\".ui-autocomplete-input\").each(function(idx, el) {\n                    if (el.value) {\n                        empty_next_inputs(el);\n                        return false;\n                    }\n                });\n            }\n        }\n    }\n\n    function storageFactory(storage){\n      var inMemoryStorage = {};\n\n      var length = 0;\n\n      function isSupported() {\n        try {\n          var testKey = \"__some_random_key_you_are_not_going_to_use__\";\n          storage.setItem(testKey, testKey);\n          storage.removeItem(testKey);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n\n      function clear(){\n        if (isSupported()) {\n          storage.clear();\n        } else {\n          inMemoryStorage = {};\n        }\n      }\n\n      function getItem(name){\n        if (isSupported()) {\n          return storage.getItem(name);\n        }\n        if (inMemoryStorage.hasOwnProperty(name)) {\n          return inMemoryStorage[name];\n        }\n        return null;\n      }\n\n      function key(index){\n        if (isSupported()) {\n          return storage.key(index);\n        } else {\n           return Object.keys(inMemoryStorage)[index] || null;\n        }\n      }\n\n      function removeItem(name){\n        if (isSupported()) {\n          storage.removeItem(name);\n        } else {\n          delete inMemoryStorage[name];\n        }\n      }\n\n      function setItem(name,value){\n        if (isSupported()) {\n          storage.setItem(name, value);\n        } else {\n          inMemoryStorage[name] = String(value); // not everyone uses TypeScript\n        }\n      }\n        return {\n            getItem : getItem,\n            setItem : setItem,\n            removeItem : removeItem,\n            clear : clear,\n            key : key,\n            length : length\n        };\n    }\n\n    function storeFormtoLocalStorage(options) {\n\n        //var form =  $( selectorFormContainer ).find(\"form\");\n\n        //var strContent = $.getMultipartData(\"#\" + form.attr(\"id\"));\n        var data = options.data || null;\n        var boundary = options.boundary || null;\n        var formData = options.formData || null;\n\n        if(typeof LZString !== \"undefined\"){\n            var compressed = LZString.compressToEncodedURIComponent(data);\n            var formD = LZString.compress(JSON.stringify(formData));\n\n            if (typeof Storage !== 'undefined') { // We have local storage support\n                sessionStore.setItem(\"form-\" +  defaultForm, compressed);// to save to local storage\n                sessionStore.setItem(\"boundary\",boundary);\n                sessionStore.setItem(defaultForm, formD);\n                // TODO: url shortner\n                //window.location.hash = compressed;\n            }\n        }\n    }\n\n    function searchFormAjax(boundary, data, url, formData){\n        $.ajax({\n            type: \"POST\",\n            contentType: 'multipart/form-data; boundary='+ boundary,\n            cache:false,\n            data: data,\n            dataType: \"html\",\n            url: url,\n            //processData:false,\n            beforeSend: beforeSendForm,\n            success: function (dataRes, status, req) {\n                /*function isnotchecked($field) {\n                    var arr = [];\n                    $.each( $field.find(\".option input[type='checkbox']:not(:checked)\") , function (ix, ch) {\n                        arr.push( $(ch).parent() );\n                    });\n                    if(arr.length > 0){\n                        return true;\n                    }\n                    return false;\n                }\n                var $fields = $( selectorFormContainer + \", \" + selectorLeftForm ).find(\"[data-fieldname]\");\n                var cheked = false;\n\n                $.each($fields,function (ix, $field) {\n                    if(!isnotchecked($field)){\n                        cheked = true;\n                    }\n                });\n\n                if(cheked){\n                    storeFormtoLocalStorage({ boundary: boundary,data: data, formData: formData});\n                }*/\n\n                storeFormtoLocalStorage({ boundary: boundary,data: data, formData: formData});\n\n                formSuccess(dataRes,status,req);\n            },\n            complete:formAjaxComplete,\n            error:formAjaxError\n        });\n    }\n\n    var defaultForm = window.location.pathname.substr(window.location.pathname.indexOf(\"@@\"), window.location.pathname.length-1) || \"defaultForm\";\n\n    function restoreFromSessionStorage(){\n        if( sessionStore.getItem(\"form-\" + defaultForm ) === null){\n            return false;\n        }\n        if (\"undefined\" === typeof LZString) {\n            console.error(\"LZString not found\");\n            return false;\n        }\n\n        try {\n            //var dec = LZString.decompressFromEncodedURIComponent(sessionStore.form);\n            var dec = LZString.decompressFromEncodedURIComponent(sessionStore.getItem(\"form-\" + defaultForm));\n\n            var form = $(selectorFormContainer).find(\"form\");\n\n            var strContent = $.getMultipartData(\"#\" + form.attr(\"id\"));\n\n            var compareVals = function (fromStorage, fromForm){\n                var notSame = false;\n\n                try {\n                    var prelFromStorage = JSON.parse(fromStorage);\n\n\n                    $.each(Object.keys(prelFromStorage), function (ix, item) {\n                       var arr = prelFromStorage[item];\n\n                       //TODO: issue on some pages especially on pagination\n                       var res = typeof fromForm[item]  !== \"undefined\" ? fromForm[item].filter( function( el ) {\n                          return arr.indexOf( el ) === -1;\n                        } )  : [];\n                        if(res.length > 0) {\n                         notSame = true;\n                         return false;\n                        }\n                    });\n\n                } catch (e) {\n                    return false;\n                }\n\n                if(!notSame) return false;\n\n                return true;\n\n            };\n\n            var defForm = sessionStore.getItem(defaultForm);\n\n            var getFormD = $.getMultipartData( \"#\" + form.attr(\"id\") , sessionStore.getItem(\"boundary\"));\n\n            if ( compareVals( LZString.decompress(defForm),strContent[2]) ) {\n\n                var url = form.attr(\"action\");\n                var boundary = sessionStore.getItem(\"boundary\");\n\n                searchFormAjax(boundary, dec, url);\n\n                // TODO: url shortner\n                //window.location.hash = sessionStore.getItem(\"form-\" + defaultForm);\n\n            } else {\n                console.log(\"same data\");\n            }\n        } catch (e) {\n            console.log(e);\n        }\n    }\n\n    function resetStorageForPage(ev){\n        var isLink = $(this).attr(\"href\").indexOf(\"@@\");\n        var href = $(this).attr(\"href\");\n        if( isLink > 0 ){\n            ev.preventDefault();\n            var ls = $(this).attr(\"href\").substr( isLink, href.length-1);\n            sessionStore.removeItem(ls);\n            sessionStore.removeItem(\"form\");\n            window.location.href = href;\n        }\n    }\n\n    function removeNoValues() {\n    /* Remove 'No value' options from all select elements\n    */\n      var $select = $('.select-widget')\n      $select.find(\"option:contains('No value')\").each(function(){\n          $(this).remove();\n      });\n    }\n\n    $.fn.fixTableHeaderAndCellsHeight = function() {\n      // because the <th> are position: absolute, they don't get the height of\n      // the <td> cells, and the other way around.\n\n      this.each(function() {\n        $(\"th\", this).each(function() {\n          var $th = $(this);\n          var $next = $('td', $th.parent());\n          var cells_max_height = Math.max($next.height());\n          var height = Math.max($th.height(), cells_max_height);\n\n          $th.height(height);\n\n          if ($th.height() >= cells_max_height) {\n            $next.height($th.height());\n          }\n\n          $('div', this).css('margin-top', '-4px');\n\n        });\n      });\n    };\n\n    function fixTableHeaderAndCellsHeight() {\n      var $table = $('.table-report');\n      $table.fixTableHeaderAndCellsHeight();\n    }\n\n    function addDoubleScroll() {\n      var secondScroll = '<div class=\"cloned-scroll-top\" style=\"overflow-x: auto;\">' +\n          '<div style=\"height: 1px; margin-left: 165px;\"></div>' +\n        '</div>'\n\n      $(\".double-scroll\").each(function(){\n        var $doubleScroll = $(this)\n        var $table = $doubleScroll.find('table');\n        var tableWidth = $table.outerWidth(includeMargin=true);\n\n        if (tableWidth == null || tableWidth <= $table.parent().width()) {\n          return\n        }\n\n        $doubleScroll.parent().before(secondScroll);\n        var $clonedScrollTop = $doubleScroll.parent().siblings('.cloned-scroll-top').first();\n\n        $clonedScrollTop.on('scroll', function(){\n          $doubleScroll.scrollLeft($clonedScrollTop.scrollLeft());\n        });\n\n        $doubleScroll.scroll(function(){\n          $clonedScrollTop.scrollLeft($doubleScroll.scrollLeft());\n        });\n\n        $clonedScrollTop.children().width(tableWidth);\n      });\n    }\n\n    jQuery(document).ready(function($){\n\n      window.setTimeout(function() {\n        initPageElems();\n      }, 100);\n\n        /*$(window).on(\"resize\", function () {\n            if (window.matchMedia(\"(max-width: 1024px)\").matches) {\n                /!*var el = $(\"#form-buttons-next-top\");\n                el.css(\"float\",\"right\");\n                $(\"#form-buttons-prev-top\").after(el);*!/\n\n                /!*$(\"#marine-widget-top > div\").css(\"display\", \"block\");\n                $(\"#marine-widget-top .field\").css(\"display\", \"block\");*!/\n            }\n        });*/\n\n        var AJAX_MODE = true;\n\n        window.WISE = {};\n        window.WISE.formData = $( selectorFormContainer ).clone(true);\n        window.WISE.blocks = [];\n\n        // ajax form submission\n        $( selectorFormContainer )\n            .unbind(\"click\")\n            .on(\"click\",\".formControls #form-buttons-continue\", function (ev){\n                if(!AJAX_MODE){\n                    return true;\n                }\n                ev.preventDefault();\n\n                // empty facets below given facet where we had an interaction\n                // this way we reset the configurations below the given facet\n                // with which we interacted with\n                var called_from = arguments[1];\n                var called_from_button = called_from && called_from['button'];\n                var called_from_select = called_from && called_from['select'];\n\n                var resetFacets = true;\n                if(resetFacets){\n                    resetConfigsbelowFacet(called_from, called_from_button, called_from_select, arguments);\n                }\n\n                var form =  $( selectorFormContainer ).find(\"form\");\n                var url = form.attr(\"action\");\n\n                var strContent = $.getMultipartData(\"#\" + form.attr(\"id\"));\n\n                searchFormAjax(strContent[0], strContent[1], url, strContent[2]);\n            });\n\n        restoreFromSessionStorage();\n\n        $(\".topnav a\").on(\"click\", resetStorageForPage);\n\n        removeNoValues();\n        fixTableHeaderAndCellsHeight();\n        addDoubleScroll();\n    });\n\n}(window, document, jQuery));\n"],"names":["window","document","$","storage","inMemoryStorage","exceptVal","selectorFormContainer","selectorLeftForm","sessionStore","sessionStorage","getItem","name","isSupported","hasOwnProperty","setItem","value","String","removeItem","clear","key","index","Object","keys","length","testKey","e","randomString","chars","randomstring","i","rnum","Math","floor","random","substring","loading","getMultipartData","frmName","newBoundary","initBoundary","strBoundary","strMultipartBody","strCRLF","formData","attr","serializeArray","res","vals","each","indx","val","push","addAutoComplete","$field","find","autocomplete","minLength","source","search","event","searchAutoComplete","data","matcher","temp","found","tohide","evtarget","target","cheks2","inputs","labels","parentsUntil","parent","no_results","show","removeClass","toSearch","toLowerCase","replace","RegExp","ui","escapeRegex","map","ind","item","text","test","filter","idx","elem","indexOf","toshow","prop","inx","removeAttr","addClass","el","checked","id","create","this","on","ev","trigger","sortCheckboxesByChecked","arr","foundArr","all","undefined","WISE","blocks","ix","ch","concat","append","generateCheckboxes","$fields","$fieldsnr","count","field","fieldId","cheks","chekspan","label","alabel","self","hide","setTimeout","button","after","spAll","trim","html","css","collapse","toggle","fadeOut","slideUp","border-bottom","fadeIn","slideDown","display","animate","opacity","checkboxHandlerAll","preventDefault","par","rest","filterInvalidCheckboxes","checkboxHandlerNone","checkboxHandlerInvert","is","unchecked","cbxs","addCheckboxLabelHandlers","allch","checkboxV","chV","setupRightSelects2","selector","forbiddenIDs","selectorFormCont","selectElement","selectedElementID","lessOptions","$wise_search_form","options","placeholder","closeOnSelect","dropdownAutoWidth","width","theme","minimumResultsForSearch","Infinity","select2","remove","select","formatArticle","article","element","subtitle","attachSelect2","marineUnitTriggerSelector","hasClass","allowClear","dropdownParent","dropdownAdapter","containerCssClass","dropdownCssClass","debug","prepend","trh","offset","top","height","margin-top","from_marine_widget","jQuery","before","trH","$selectArticle","fn","formatSelection","formatResult","one","location","href","choice","w","daw","matchMedia","matches","sect","marineBtnHandler","dir","direction","selectedV","nextEl","next","prevEl","prev","paginationTextResult","initPaginationInput","parseInt","bind","maximum","validator","x","isNaN","validateNr","focus","initPageElems","$controls","prevButton","continueBtn","formBtnPrevTop","marineUnitTrigger","pagination","eq","detach","insertBefore","ajaxSpinner","clone","fbDownload","dBtn","btnForm","setupTabs","clickFirstTab","nextButton","opts","formBtnNextTop","beforeSendForm","jqXHR","settings","cont","sp","position","sortable","cell","exec","charAt","parseFloat","sort","usenumbers","th","closest","colnum","table","parents","tbody","reverse","children","cells","sortableitem","slice","a","b","setoddeven","end","formAjaxComplete","textStatus","siblings","blankarrow","click","scanforlinks","addDoubleScroll","formAjaxError","req","status","error","Storage","resetEmptyCheckboxes","fieldID","searchFormAjax","boundary","url","ajax","type","contentType","cache","dataType","beforeSend","success","dataRes","$data","centerContentD","LZString","compressed","compressToEncodedURIComponent","formD","compress","JSON","stringify","defaultForm","fhtml","removeNoValues","fixTableHeaderAndCellsHeight","complete","pathname","substr","restoreFromSessionStorage","dec","decompressFromEncodedURIComponent","form","strContent","defForm","fromStorage","fromForm","notSame","prelFromStorage","parse","compareVals","decompress","console","log","resetStorageForPage","isLink","ls","$clonedScrollTop","$doubleScroll","$table","tableWidth","outerWidth","includeMargin","first","scrollLeft","scroll","$th","$next","cells_max_height","max","ready","unbind","called_from","empty_next_inputs","arguments","called_from_button","called_from_select","panel_group","subform_children","nextAll","empty","empty_sibling_input","nextFieldID"],"mappings":"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"}